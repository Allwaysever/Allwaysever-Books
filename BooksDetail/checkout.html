<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout buku | Allwaysever Books</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
/* DETAIL.CSS - CSS Detail Buku dan Checkout (Expert Refactoring) */

/* 1. CSS Variables: Memudahkan maintenance dan konsistensi warna */
:root {
    --color-dark-bg: #0f0f0f;
    --color-card-bg: #1a1a1a;
    --color-text-light: #fff;
    --color-text-secondary: #aaa;
    --color-accent-yellow: #ffce00; /* Kuning utama */
    --color-action-green: #28a745; /* Hijau Proses Pembayaran */
    --color-input-bg: #f0f0f0; /* Putih input */
    
    --border-radius-card: 35px;
    --border-radius-element: 1rem; /* 16px */
    --spacing-default: 1.25rem; /* 20px */
}

/* --- 2. GENERAL STYLE --- */
body {
    background-color: var(--color-dark-bg);
    font-family: Arial, sans-serif;
    color: var(--color-text-light);
    margin: 0;
    padding-bottom: 2rem; /* 32px */
}
.container {
    max-width: 800px;
    margin: 0 auto;
    padding: var(--spacing-default);
}

/* --- 3. HEADER & BACK BUTTON --- */
.detail-header {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    margin-bottom: var(--spacing-default);
}
.back-button {
    color: var(--color-text-light);
    text-decoration: none;
    font-size: 1.1rem;
    padding: 0.3rem 0.6rem;
    border-radius: var(--border-radius-element);
    transition: opacity 0.1s, filter 0.1s;
    font-weight: bold; 
    filter: brightness(1); 
}
.back-button:active { 
    opacity: 0.7; 
    filter: brightness(0.9);
}

/* --- 4. CARD DETAIL & CHECKOUT --- */
.detail-card, .checkout-card {
    background-color: var(--color-card-bg);
    border-radius: var(--border-radius-card); 
    padding: 2rem; 
    margin-top: 1rem;
    /* Box-shadow lebih dalam */
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
}

/* ======================================================= */
/* --- 5. CHECKOUT SPECIFIC STYLES --- */
/* ======================================================= */
.checkout-card h2 {
    font-size: 1.8rem;
    margin-bottom: 2rem;
    color: var(--color-accent-yellow); 
    text-align: center;
    font-weight: bold;
    /* Text shadow untuk efek 'bersinar' */
    text-shadow: 0 0 5px rgba(255, 206, 0, 0.3);
}

/* --- Rincian Harga Baru --- */
.price-details {
    padding: 0 0 1rem 0; /* Padding bawah */
    margin-top: 1.5rem;
    border-bottom: 1px dashed #333; /* Border putus-putus */
}
.price-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0.5rem;
    font-size: 1rem;
    color: var(--color-text-secondary);
}
.price-item .label {
    font-weight: normal;
}
.price-item .value {
    font-weight: bold;
    color: var(--color-text-light);
}

/* --- Ringkasan Total Pembayaran (Total Row) --- */
.payment-summary.total-row {
    background-color: transparent; 
    padding: 1rem 0; 
    margin-top: 0.5rem; /* Lebih dekat ke price-details */
    font-size: 1.15rem;
    display: flex;
    justify-content: space-between;
    font-weight: bold;
    border-bottom: none; /* Hilangkan border bawah yang lama */
}
.payment-summary.total-row .price-tag {
    color: var(--color-accent-yellow); /* Highlight Total */
    font-size: 1.25rem;
}

/* --- Tombol Link Pembayaran QRIS (Warna Biru) --- */
.action-button.qris-link {
    background-color: #007bff; /* Biru */
    color: var(--color-text-light);
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.6);
}

/* --- Tombol Konfirmasi Pembayaran (Warna Merah/Orange) --- */
.action-button.confirmation {
    background-color: #db4437; /* Warna Google Red-Orange */
    color: var(--color-text-light);
    box-shadow: 0 4px 15px rgba(219, 68, 55, 0.6);
}

/* --- Note Informasi Pembayaran --- */
.note {
    font-size: 0.85rem;
    color: var(--color-text-secondary);
    margin-top: 1rem;
    text-align: center;
}

/* ======================================================= */
/* --- 6. SHARED BUTTONS & TAGS (For Detail Pages) --- */
/* ======================================================= */

/* Base Tombol Aksi */
.action-button {
    display: block;
    text-align: center;
    padding: 1rem;
    border-radius: var(--border-radius-element);
    text-decoration: none;
    font-weight: bold;
    font-size: 1.1rem;
    margin-top: var(--spacing-default);
    cursor: pointer;
    transition: transform 0.1s;
}
.action-button:active { transform: scale(0.98); }
    </style>
</head>
<body>
    <div class="container">
        <div class="detail-header">
            <a href="javascript:history.back()" class="back-button"><i class="fa-solid fa-arrow-left"></i> Kembali</a>
        </div>

<div class="checkout-card">
    <h2>Ringkasan Pembayaran</h2>

    <div class="price-details">
        <div class="price-item">
            <span class="label">Harga Produk</span>
            <span class="value" id="base-price">Rp 0</span>
        </div>
        <div class="price-item admin-fee-row">
            <span class="label">Biaya Admin</span>
            <span class="value" id="admin-fee">Rp 0</span>
        </div>
    </div>

    <div class="payment-summary total-row">
        <span>Total Pembayaran</span>
        <span class="price-tag" id="total-price">Rp 0</span>
    </div>
    <h3 style="color: var(--color-accent-yellow); text-align: center; margin-top: 2rem; margin-bottom: 1rem;">Pilih Metode Pembayaran</h3>

    <div id="qris-section" style="padding-top: 1rem;">
        
        <p style="text-align: center; color: var(--color-text-secondary); margin-bottom: 1.5rem;">
            Gunakan tautan atau pindai QR Code di bawah (Total Otomatis: <span id="total-text-qris">Rp 0</span>)
        </p>

        <div style="text-align: center; margin-bottom: 1.5rem;">
            <img id="qris-iframe" src="https://raw.githubusercontent.com/Allwaysever/Allwaysever-Books/refs/heads/main/Assets/Images/QRCode.jpg"
                    width="200" height="200" style="border: none; border-radius: var(--border-radius-element);"
                    title="QRIS Pembayaran eBook">
            </img>
        </div>

        <a href="https://saweria.co/AllwayseverBooks" 
           target="_blank" 
           class="action-button qris-link"
           style="background-color: var(--color-action-green); box-shadow: 0 4px 15px rgba(40, 167, 69, 0.6);">
            <i class="fa-solid fa-up-right-from-square"></i> Bayar Sekarang via QRIS/Saweria
        </a>

        <a href="https://forms.gle/7dA5JYtx8a1cyDz59" 
           target="_blank" 
           class="action-button confirmation"
           style="margin-top: 1rem;">
            <i class="fa-solid fa-receipt"></i> <b>WAJIB:</b> Isi Form Konfirmasi & Data Kirim
        </a>
        
        <p class="note" style="margin-top: 1.5rem;">
            Pembayaran akan dicek setelah pengisian form konfirmasi. Harap simpan bukti transfer Anda.
        </p>
    </div>
    </div>

<script>
    // FUNGSI UTILITY: Mendapatkan parameter dari URL
    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    };

    // 1. Database Harga Produk dan Biaya Admin (Sama dengan file detail)
    const productDB = {
        // Format: 'KODE_PRODUK': { name: 'Nama Produk', basePrice: HARGA_DASAR }
        'DPEbyDESSB': { name: 'Digital Product Empire', basePrice: 5000 },
        'DEVPATH01': { name: 'The Development Path', basePrice: 80000 },
        'ADVJS02': { name: 'Advanced JS Patterns', basePrice: 120000 },
    };

    const ADMIN_FEE = 1000; // Biaya Admin tetap (Rp 3.000)
    
    // Ambil kode produk dari URL yang dilempar oleh halaman detail (e.g., checkout.html?code=DEVPATH01)
    const CURRENT_PRODUCT_CODE = getUrlParameter('code') || 'DEVPATH01'; // Default ke DEVPATH01
    const product = productDB[CURRENT_PRODUCT_CODE];
    
    let basePrice = 0;
    let totalPrice = 0;
    
    if (product) {
        basePrice = product.basePrice;
        totalPrice = basePrice + ADMIN_FEE;
    } else {
        console.error("Kode Produk tidak ditemukan. Menggunakan harga 0.");
    }

    // Fungsi untuk memperbarui tampilan harga di HTML
    function updatePriceDisplay() {
        if (!product) {
            // Jika produk tidak ditemukan, tampilkan pesan error
            document.querySelector('.checkout-card h2').textContent = 'Produk Tidak Ditemukan!';
            document.getElementById('base-price').textContent = '-';
            document.getElementById('admin-fee').textContent = '-';
            document.getElementById('total-price').textContent = '-';
            document.getElementById('total-text-qris').textContent = '0';
            return;
        }

        const formattedBasePrice = 'Rp ' + basePrice.toLocaleString('id-ID');
        const formattedAdminFee = 'Rp ' + ADMIN_FEE.toLocaleString('id-ID');
        const formattedTotalPrice = 'Rp ' + totalPrice.toLocaleString('id-ID');

        // Tampilkan Harga Dasar
        document.getElementById('base-price').textContent = formattedBasePrice;

        // Tampilkan Biaya Admin
        document.getElementById('admin-fee').textContent = formattedAdminFee;

        // Tampilkan Total Pembayaran
        document.getElementById('total-price').textContent = formattedTotalPrice;
        
        // Tampilkan Total Pembayaran di dalam teks deskripsi
        document.getElementById('total-text-qris').textContent = formattedTotalPrice;
        
        // Update Judul
        document.querySelector('.checkout-card h2').textContent = 'Ringkasan Pembayaran: ' + product.name;
    }

    // Panggil fungsi update segera setelah script dimuat
    updatePriceDisplay();
</script>
</body>
</html>
